<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head th:replace="seller/fragments/head :: head">
    <title>Quản lý đánh giá sản phẩm</title>
</head>
<body>
<div class="dashboard-container">
    <div th:replace="seller/fragments/sidebar :: sidebar"></div>
    <main class="main-content">
        <div th:replace="seller/fragments/header :: header"></div>
        <div class="review-page-container" style="max-width:100%;margin:32px auto 0 auto;box-shadow:0 2px 16px #e0e7ef;background:#fff;border-radius:18px;padding:32px 36px;">
            <div class="seller-page-header" style="margin-bottom:32px;">
                <div class="header-icon"><i class="fa-solid fa-star"></i></div>
                <div class="header-title-group">
                    <div class="header-title">Quản lý đánh giá sản phẩm</div>
                    <div class="header-subtitle">Theo dõi và quản lý tất cả đánh giá sản phẩm của shop bạn một cách hiệu quả</div>
                </div>
            </div>
            <h2 style="font-size:2rem;font-weight:800;color:#1e3a8a;margin-bottom:24px;">Quản lý đánh giá sản phẩm</h2>
            <div class="review-stats" style="margin-bottom:24px;display:flex;gap:32px;align-items:center;flex-wrap:wrap;">
                <div><b>Tổng đánh giá:</b> <span th:text="${stats.totalReviews}"></span></div>
                <div><b>Trung bình sao:</b> <span th:text="${stats.averageRating}"></span> <i class="fa-solid fa-star" style="color:#FFD600;"></i></div>
                <div><b>Có ảnh:</b> <span th:text="${stats.reviewsWithImages}"></span></div>
                <div><b>Phân bố sao:</b>
                    <span th:each="star : ${starList}" style="margin-right:10px;">
                        <span th:text="${star}"></span><i class="fa-solid fa-star" style="color:#FFD600;"></i>:
                        <span th:text="${stats.starDistribution[star.toString()]}"></span>
                    </span>
                </div>
            </div>
            <form class="review-filter" method="get" style="display:flex;flex-wrap:wrap;gap:12px;align-items:center;margin-bottom:28px;background:#f8fafc;padding:16px 18px;border-radius:12px;box-shadow:0 1px 6px #e0e7ef;">
                <select name="productId" id="productFilter" style="padding:8px 12px;border-radius:8px;border:1px solid #e2e8f0;min-width:180px;">
                    <option value="">Tất cả sản phẩm</option>
                    <option th:each="p : ${products}" th:value="${p.id}" th:text="${p.name}" th:selected="${p.id} == ${param.productId}"></option>
                </select>
                <select name="rating" id="starFilter" style="padding:8px 12px;border-radius:8px;border:1px solid #e2e8f0;min-width:120px;">
                    <option value="">Tất cả sao</option>
                    <option value="5" th:selected="${param.rating} == 5">5 sao</option>
                    <option value="4" th:selected="${param.rating} == 4">4 sao</option>
                    <option value="3" th:selected="${param.rating} == 3">3 sao</option>
                    <option value="2" th:selected="${param.rating} == 2">2 sao</option>
                    <option value="1" th:selected="${param.rating} == 1">1 sao</option>
                </select>
                <label style="display:flex;align-items:center;gap:4px;font-weight:500;color:#1e3a8a;min-width:70px;white-space:nowrap;">
                    <input type="checkbox" name="hasImage" th:checked="${param.hasImage}" value="true"> Có ảnh
                </label>
                <input type="date" name="fromDate" th:value="${param.fromDate}" style="padding:8px 12px;border-radius:8px;border:1px solid #e2e8f0;min-width:140px;">
                <input type="date" name="toDate" th:value="${param.toDate}" style="padding:8px 12px;border-radius:8px;border:1px solid #e2e8f0;min-width:140px;">
                <button type="submit" class="btn-primary" style="padding:8px 20px;border-radius:8px;min-width:70px;">Lọc</button>
            </form>
            <div class="review-card-list" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(380px,1fr));gap:28px;">
                <div class="review-card" th:each="review : ${reviews}" style="display:flex;gap:18px;background:#f8fafc;border-radius:14px;box-shadow:0 1px 6px #e0e7ef;padding:18px 18px 18px 12px;align-items:flex-start;">
                    <div class="product-thumb" style="min-width:110px;max-width:110px;">
                        <img th:src="${review.productImage}" alt="Ảnh sản phẩm" style="width:100px;height:100px;object-fit:cover;border-radius:10px;border:1.5px solid #e2e8f0;"/>
                    </div>
                    <div class="review-content" style="flex:1;">
                        <div class="review-product-name" th:text="${review.productName}" style="font-weight:700;font-size:1.1rem;color:#1e3a8a;margin-bottom:4px;"></div>
                        <div class="review-rating" style="margin-bottom:4px;">
                            <span th:each="i : ${#numbers.sequence(1, review.rating)}">
                                <i class="fa-solid fa-star" style="color:#FFD600;"></i>
                            </span>
                            <span th:each="i : ${#numbers.sequence(review.rating+1, 5)}">
                                <i class="fa-regular fa-star" style="color:#FFD600;"></i>
                            </span>
                        </div>
                        <div class="review-text" th:text="${review.comment}" style="margin-bottom:8px;color:#222;"></div>
                        <div class="review-images" th:if="${review.reviewImages != null && !#lists.isEmpty(review.reviewImages)}" style="display:flex;gap:8px;margin-bottom:8px;">
                            <img th:each="img : ${review.reviewImages}" th:src="${img}" class="review-img-thumb" alt="Ảnh đánh giá" style="width:60px;height:60px;object-fit:cover;border-radius:7px;border:1px solid #e2e8f0;">
                        </div>
                        <div class="review-meta" style="font-size:0.95rem;color:#64748b;margin-bottom:6px;">
                            <span th:text="${review.customerName}"></span> |
                            <span th:text="${#dates.format(review.createdAt, 'dd/MM/yyyy')}"></span>
                        </div>
                        <a th:href="@{'/seller/reviews/' + ${review.reviewId}}" class="btn-secondary btn-detail" style="padding:6px 16px;border-radius:7px;font-size:0.95rem;">Xem chi tiết</a>
                    </div>
                </div>
                <div th:if="${#lists.isEmpty(reviews)}" style="text-align:center;color:#888;margin-top:32px;grid-column:1/-1;">Không có đánh giá nào phù hợp.</div>
            </div>
        </div>
    </main>
</div>
</body>
</html> 