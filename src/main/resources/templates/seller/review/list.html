<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Quản lý đánh giá sản phẩm</title>
    <link rel="stylesheet" th:href="@{/assets/css/SellerReview.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
</head>
<body>
<div class="review-container">
    <h2>Quản lý đánh giá sản phẩm</h2>
    <div class="review-stats" style="margin-bottom:24px;display:flex;gap:32px;align-items:center;">
        <div><b>Tổng đánh giá:</b> <span th:text="${stats.totalReviews}"></span></div>
        <div><b>Trung bình sao:</b> <span th:text="${stats.averageRating}"></span> <i class="fa-solid fa-star" style="color:#FFD600;"></i></div>
        <div><b>Có ảnh:</b> <span th:text="${stats.reviewsWithImages}"></span></div>
        <div><b>Phân bố sao:</b>
            <span th:each="star : ${starList}">
                <span th:text="${star}"></span><i class="fa-solid fa-star" style="color:#FFD600;"></i>:
                <span th:text="${stats.starDistribution[star]}"></span>
            </span>
        </div>
    </div>
    <form class="review-filter" method="get">
        <select name="productId" id="productFilter">
            <option value="">Tất cả sản phẩm</option>
            <option th:each="p : ${products}" th:value="${p.id}" th:text="${p.name}" th:selected="${p.id} == ${param.productId}"></option>
        </select>
        <select name="rating" id="starFilter">
            <option value="">Tất cả sao</option>
            <option value="5" th:selected="${param.rating} == 5">5 sao</option>
            <option value="4" th:selected="${param.rating} == 4">4 sao</option>
            <option value="3" th:selected="${param.rating} == 3">3 sao</option>
            <option value="2" th:selected="${param.rating} == 2">2 sao</option>
            <option value="1" th:selected="${param.rating} == 1">1 sao</option>
        </select>
        <label>
            <input type="checkbox" name="hasImage" th:checked="${param.hasImage}" value="true"> Có ảnh
        </label>
        <input type="date" name="fromDate" th:value="${param.fromDate}">
        <input type="date" name="toDate" th:value="${param.toDate}">
        <button type="submit">Lọc</button>
    </form>
    <div class="review-list">
        <div class="review-item" th:each="review : ${reviews}">
            <div class="product-thumb">
                <img th:src="${review.productImage}" alt="Ảnh sản phẩm"/>
            </div>
            <div class="review-content">
                <div class="product-name" th:text="${review.productName}"></div>
                <div class="review-stars">
                    <span th:each="i : ${#numbers.sequence(1, review.rating)}">
                        <i class="fa-solid fa-star"></i>
                    </span>
                    <span th:each="i : ${#numbers.sequence(review.rating+1, 5)}">
                        <i class="fa-regular fa-star"></i>
                    </span>
                </div>
                <div class="review-text" th:text="${review.comment}"></div>
                <div class="review-images" th:if="${review.reviewImages != null && !#lists.isEmpty(review.reviewImages)}">
                    <img th:each="img : ${review.reviewImages}" th:src="${img}" class="review-img-thumb" alt="Ảnh đánh giá">
                </div>
                <div class="review-meta">
                    <span th:text="${review.customerName}"></span> |
                    <span th:text="${#dates.format(review.createdAt, 'dd/MM/yyyy')}"></span>
                </div>
                <a th:href="@{'/seller/reviews/' + ${review.reviewId}}" class="btn-detail">Xem chi tiết</a>
            </div>
        </div>
        <div th:if="${#lists.isEmpty(reviews)}" style="text-align:center;color:#888;margin-top:32px;">Không có đánh giá nào phù hợp.</div>
    </div>
</div>
</body>
</html> 