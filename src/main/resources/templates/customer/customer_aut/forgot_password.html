<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quên mật khẩu</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #0a4d68;
            --secondary-blue: #088395;
            --accent-teal: #05bfdb;
            --light-green: #8de0a6;
            --light-gray: #f8f8f8;
            --border-gray: #e5e5e5;
            --text-gray: #666666;
            --white: #ffffff;
            --gold-accent: #d4af37;
            --error-red: #dc2626;
            --success-green: #10b981;
            --shadow-light: rgba(10, 77, 104, 0.05);
            --shadow-medium: rgba(10, 77, 104, 0.1);
            --shadow-heavy: rgba(10, 77, 104, 0.15);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--light-green) 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: var(--primary-blue);
            line-height: 1.6;
            position: relative;
        }

        /* Animated background elements */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.5;
            animation: float 20s ease-in-out infinite;
            pointer-events: none;
            z-index: -1;
        }

        .forgot-container {
            background: var(--white);
            border-radius: 24px;
            box-shadow:
                    0 32px 64px var(--shadow-light),
                    0 16px 32px var(--shadow-medium),
                    0 0 0 1px rgba(255, 255, 255, 0.1);
            overflow: hidden;
            width: 100%;
            max-width: 480px;
            animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1);
            position: relative;
            z-index: 1;
        }

        .forgot-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-blue) 0%, var(--accent-teal) 50%, var(--primary-blue) 100%);
        }

        /* Logo Section */
        .logo-section {
            padding: 40px 40px 20px;
            text-align: center;
            border-bottom: 1px solid var(--border-gray);
            background: var(--white);
        }

        .logo-container {
            display: inline-block;
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .logo-container:hover {
            transform: translateY(-2px);
        }

        .logo-placeholder {
            width: 140px;
            height: 60px;
            background: var(--white);
            border: 2px dashed rgba(10, 77, 104, 0.3);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-blue);
            font-size: 11px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px var(--shadow-light);
        }

        .logo-placeholder:hover {
            border-color: var(--accent-teal);
            background: var(--white);
            transform: scale(1.05);
        }

        /* Header Section */
        .forgot-header {
            padding: 40px 40px 30px;
            text-align: center;
            background: var(--white);
        }

        .forgot-icon {
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, var(--secondary-blue) 0%, var(--accent-teal) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            font-size: 24px;
            color: var(--white);
            position: relative;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(8, 131, 149, 0.3);
        }

        .forgot-icon::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.6s;
        }

        .forgot-icon:hover::before {
            left: 100%;
        }

        .forgot-header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 32px;
            font-weight: 600;
            color: var(--primary-blue);
            margin-bottom: 12px;
            letter-spacing: -0.5px;
        }

        .forgot-subtitle {
            font-size: 15px;
            color: var(--text-gray);
            font-weight: 400;
            line-height: 1.5;
            max-width: 320px;
            margin: 0 auto;
        }

        /* Body Section */
        .forgot-body {
            padding: 0 40px 40px;
            background: var(--white);
        }

        .instructions {
            background: linear-gradient(135deg, rgba(8, 131, 149, 0.05) 0%, rgba(5, 191, 219, 0.05) 100%);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 32px;
            border-left: 4px solid var(--secondary-blue);
            position: relative;
        }

        .instructions::before {
            content: '';
            position: absolute;
            top: 16px;
            right: 16px;
            width: 6px;
            height: 6px;
            background: var(--accent-teal);
            border-radius: 50%;
        }

        .instructions p {
            color: var(--text-gray);
            font-size: 14px;
            line-height: 1.6;
            margin: 0;
        }

        .form-group {
            margin-bottom: 28px;
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 12px;
            font-weight: 500;
            color: var(--primary-blue);
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .input-wrapper {
            position: relative;
        }

        .form-control {
            width: 100%;
            padding: 18px 20px;
            border: 2px solid var(--border-gray);
            border-radius: 12px;
            font-size: 15px;
            font-weight: 400;
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            background: var(--light-gray);
            color: var(--primary-blue);
            font-family: inherit;
        }

        .form-control::placeholder {
            color: var(--text-gray);
            font-weight: 400;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--secondary-blue);
            background: var(--white);
            box-shadow: 0 0 0 4px rgba(8, 131, 149, 0.1);
            transform: translateY(-1px);
        }

        .submit-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--secondary-blue) 0%, var(--accent-teal) 100%);
            color: var(--white);
            padding: 18px 24px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            position: relative;
            overflow: hidden;
            font-family: inherit;
            box-shadow: 0 8px 25px rgba(8, 131, 149, 0.3);
        }

        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.6s;
        }

        .submit-btn:hover::before {
            left: 100%;
        }

        .submit-btn:hover {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
            transform: translateY(-2px);
            box-shadow: 0 16px 32px rgba(8, 131, 149, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .submit-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        .message {
            margin: 24px 0;
            padding: 16px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            text-align: center;
            animation: slideIn 0.5s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .success-message {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-green);
            border: 2px solid rgba(16, 185, 129, 0.2);
            border-left: 4px solid var(--success-green);
        }

        .error-message {
            background: rgba(220, 38, 38, 0.1);
            color: var(--error-red);
            border: 2px solid rgba(220, 38, 38, 0.2);
            border-left: 4px solid var(--error-red);
        }

        .back-link {
            text-align: center;
            margin-top: 32px;
            padding-top: 24px;
            border-top: 1px solid var(--border-gray);
        }

        .back-link a {
            color: var(--text-gray);
            text-decoration: none;
            font-weight: 500;
            font-size: 13px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .back-link a:hover {
            color: var(--secondary-blue);
            transform: translateX(-4px);
        }

        .back-link a::before {
            content: '←';
            font-size: 16px;
            transition: transform 0.3s ease;
        }

        .back-link a:hover::before {
            transform: translateX(-2px);
        }

        /* Loading state */
        .submit-btn.loading {
            color: transparent;
            pointer-events: none;
        }

        .submit-btn.loading::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            top: 50%;
            left: 50%;
            margin-left: -10px;
            margin-top: -10px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--white);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-16px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        /* Responsive Design */
        @media (max-width: 640px) {
            body {
                padding: 16px;
            }

            .forgot-container {
                border-radius: 20px;
                max-width: 100%;
            }

            .logo-section,
            .forgot-header,
            .forgot-body {
                padding-left: 24px;
                padding-right: 24px;
            }

            .forgot-header {
                padding-top: 32px;
                padding-bottom: 24px;
            }

            .forgot-body {
                padding-bottom: 32px;
            }

            .forgot-header h1 {
                font-size: 28px;
            }

            .forgot-subtitle {
                font-size: 14px;
            }

            .logo-placeholder {
                width: 120px;
                height: 50px;
            }
        }

        @media (max-width: 480px) {
            .logo-section,
            .forgot-header,
            .forgot-body {
                padding-left: 20px;
                padding-right: 20px;
            }

            .forgot-header h1 {
                font-size: 24px;
            }

            .instructions {
                padding: 20px;
            }
        }

        /* Focus states for accessibility */
        .form-control:focus,
        .submit-btn:focus,
        .back-link a:focus,
        .logo-container:focus {
            outline: 2px solid var(--accent-teal);
            outline-offset: 2px;
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            .form-control {
                border-width: 3px;
            }

            .submit-btn {
                border: 3px solid var(--secondary-blue);
            }
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
<div class="forgot-container">
    <!-- Logo Section -->
    <div class="logo-section">
        <a href="/home" class="logo-container" aria-label="Về trang chủ">
            <div class="logo-placeholder">
                <!-- Replace this div with your logo image -->
                <span>Your Logo</span>
            </div>
        </a>
    </div>

    <!-- Header Section -->
    <div class="forgot-header">
        <div class="forgot-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 10V8C6 5.79086 7.79086 4 10 4H14C16.2091 4 18 5.79086 18 8V10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <rect x="4" y="10" width="16" height="10" rx="2" stroke="currentColor" stroke-width="2"/>
                <circle cx="12" cy="15" r="1" fill="currentColor"/>
            </svg>
        </div>
        <h1>Quên mật khẩu</h1>
        <p class="forgot-subtitle">Đừng lo lắng, chúng tôi sẽ giúp bạn khôi phục quyền truy cập vào tài khoản của bạn</p>
    </div>

    <!-- Body Section -->
    <div class="forgot-body">
        <div class="instructions">
            <p>Vui lòng nhập địa chỉ email bạn đã sử dụng để đăng ký tài khoản. Chúng tôi sẽ gửi cho bạn một liên kết bảo mật để đặt lại mật khẩu.</p>
        </div>

        <form th:action="@{/customers/forgot_password}" method="post" id="forgotPasswordForm">
            <div class="form-group">
                <label for="email">Địa chỉ email</label>
                <div class="input-wrapper">
                    <input
                            type="email"
                            name="email"
                            id="email"
                            class="form-control"
                            required
                            placeholder="example@domain.com"
                            autocomplete="email"
                            aria-describedby="email-help"
                    >
                </div>
            </div>

            <button type="submit" class="submit-btn" id="submitBtn">
                Gửi liên kết đặt lại mật khẩu
            </button>
        </form>

        <div th:if="${message}" th:text="${message}" class="message success-message"></div>
        <div th:if="${errorMessage}" th:text="${errorMessage}" class="message error-message"></div>

        <div class="back-link">
            <a th:href="@{/login}">Quay lại đăng nhập</a>
        </div>
    </div>
</div>

<script>
    // Form validation and enhanced UX
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('forgotPasswordForm');
        const emailInput = document.getElementById('email');
        const submitBtn = document.getElementById('submitBtn');

        // Enhanced email validation
        function isValidEmail(email) {
            const emailRegex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;
            return emailRegex.test(email);
        }

        // Real-time validation feedback
        emailInput.addEventListener('input', function() {
            const email = this.value.trim();

            if (email && !isValidEmail(email)) {
                this.style.borderColor = '#dc2626';
                this.style.boxShadow = '0 0 0 4px rgba(220, 38, 38, 0.1)';
            } else {
                this.style.borderColor = '';
                this.style.boxShadow = '';
            }
        });

        // Form submission handling
        form.addEventListener('submit', function(e) {
            const email = emailInput.value.trim();

            // Remove any existing error messages
            const existingError = document.querySelector('.error-message');
            if (existingError && !existingError.hasAttribute('th:if')) {
                existingError.remove();
            }

            // Validate email
            if (!email || !isValidEmail(email)) {
                e.preventDefault();

                // Create and show error message
                const errorMsg = document.createElement('div');
                errorMsg.className = 'message error-message';
                errorMsg.textContent = 'Vui lòng nhập địa chỉ email hợp lệ.';
                form.appendChild(errorMsg);

                // Focus on email input
                emailInput.focus();
                emailInput.style.borderColor = '#dc2626';
                emailInput.style.boxShadow = '0 0 0 4px rgba(220, 38, 38, 0.1)';

                return false;
            }

            // Add loading state
            submitBtn.classList.add('loading');
            submitBtn.disabled = true;

            // Prevent double submission
            setTimeout(() => {
                if (submitBtn.classList.contains('loading')) {
                    submitBtn.classList.remove('loading');
                    submitBtn.disabled = false;
                }
            }, 10000); // 10 second timeout
        });

        // Auto-hide messages after 7 seconds
        setTimeout(() => {
            const messages = document.querySelectorAll('.message');
            messages.forEach(message => {
                if (message.textContent.trim() !== '') {
                    message.style.transition = 'opacity 0.5s cubic-bezier(0.16, 1, 0.3, 1), transform 0.5s cubic-bezier(0.16, 1, 0.3, 1)';
                    message.style.opacity = '0';
                    message.style.transform = 'translateY(-8px)';
                    setTimeout(() => {
                        message.style.display = 'none';
                    }, 500);
                }
            });
        }, 7000);

        // Enhanced keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                // Clear focus from current element
                document.activeElement.blur();
            }
        });
    });
</script>
</body>
</html>