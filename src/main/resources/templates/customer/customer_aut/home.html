<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trang chủ - E-Commerce Platform</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-black: #1a2233;
      --secondary-black: #222b45;
      --accent-gray: #e0e7ef;
      --light-gray: #f5f7fa;
      --border-gray: #e5eaf2;
      --text-gray: #6b7280;
      --white: #ffffff;
      --gold-accent: #f7c873;
      --success-green: #10b981;
      --error-red: #dc2626;
      --orange-accent: #ff7a45;
      --blue-accent: #3b82f6;
      --shopee-orange: #ee4d2d;
      --shadow-light: rgba(16, 42, 67, 0.04);
      --shadow-medium: rgba(16, 42, 67, 0.10);
      --shadow-heavy: rgba(16, 42, 67, 0.18);
      --gradient-start: #0a4d68;
      --gradient-mid: #088395;
      --gradient-end: #05bfdb;
      --gradient-light-end: #8de0a6;
      --primary: #088395;
      --accent: #F7EEDD;
    }
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #e0f7fa 0%, #f5fafd 100%);
      color: #111 !important;
      margin: 0;
      padding: 0;
    }
    h1, h2, h3, h4, h5, h6, p, a, span, div, label, input, button, .products-title, .category-header, .category-label, .account-link, .user-avatar, .account-menu-list a {
      color: #111 !important;
    }
    /* Header */
    .main-header {
      background: linear-gradient(90deg, #0a4d68 0%, #05bfdb 100%);
      box-shadow: 0 2px 16px var(--shadow-light);
      border-radius: 0 0 18px 18px;
      padding: 0 32px;
      height: 88px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .header-left { display: flex; align-items: center; gap: 18px; }
    .logo { font-size: 2.6rem; font-weight: 700; color: #111 !important; letter-spacing: 1px; }
    .logo-img {
      height: 80px !important;
      width: auto !important;
      display: block;
      margin-right: 8px;
      filter: drop-shadow(0 2px 8px #05bfdb33);
    }
    .search-bar {
      flex: unset;
      margin: 0 auto;
      display: flex;
      align-items: center;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 12px var(--shadow-light);
      padding: 0 16px;
      width: 900px;
      border: 2px solid #05bfdb22;
    }
    .search-bar input {
      border: none;
      background: transparent;
      font-size: 1.1rem;
      flex: 1;
      padding: 12px 0;
      outline: none;
      color: #111 !important;
    }
    .search-bar button {
      background: linear-gradient(90deg, #088395 0%, #05bfdb 100%);
      color: #fff;
      border: none;
      border-radius: 8px;
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      margin-left: 8px;
      transition: background 0.2s;
      box-shadow: 0 2px 8px var(--shadow-light);
    }
    .search-bar button:hover { background: #0a4d68; }
    .header-right { display: flex; align-items: center; gap: 18px; overflow-x: auto; white-space: nowrap; max-width: 250px; }
    .account-link {
      font-size: 1rem;
      font-weight: 600;
      color: #111 !important;
      background: none;
      padding: 0 0 0 2px;
      text-decoration: none;
      position: relative;
      cursor: pointer;
    }
    .user-info-box { position: relative; display: flex; align-items: center; gap: 4px; }
    .user-info-box:hover .account-menu-list,
    .user-info-box:focus-within .account-menu-list {
      display: block;
      opacity: 1;
      visibility: visible;
    }
    .account-menu-list {
      display: none;
      position: fixed;
      top: 72px;
      right: 32px;
      background: #fff;
      min-width: 200px;
      border-radius: 16px;
      box-shadow: 0 16px 48px rgba(16,42,67,0.13);
      border: 1px solid #e0e7ef;
      overflow: visible;
      z-index: 9999;
      animation: slideDown 0.3s cubic-bezier(0.16, 1, 0.3, 1);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s, visibility 0.2s;
    }
    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-8px) scale(0.95); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }
    .account-menu-list::before {
      content: '';
      position: absolute;
      top: -6px;
      right: 20px;
      width: 12px;
      height: 12px;
      background: #fff;
      border: 1px solid #e0e7ef;
      border-bottom: none;
      border-right: none;
      transform: rotate(45deg);
    }
    .account-menu-list a {
      color: var(--primary-black);
      padding: 12px 20px;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 1rem;
      font-weight: 500;
      transition: background 0.15s, color 0.15s, transform 0.15s;
      border-left: 3px solid transparent;
      white-space: normal;
      word-break: break-word;
    }
    .account-menu-list a:hover {
      background: var(--accent-gray);
      border-left-color: var(--gradient-mid);
      color: var(--gradient-mid);
      transform: translateX(4px);
    }
    .account-menu-list a:not(:last-child) {
      border-bottom: 1px solid #e0e7ef;
    }
    .user-avatar {
      width: auto;
      height: auto;
      background: none;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      font-weight: 600;
      border-radius: 0;
      overflow: visible;
      padding: 0;
    }
    .user-avatar img {
      width: 32px;
      height: 32px;
      object-fit: cover;
      border-radius: 50%;
      display: block;
    }
    /* Banner */
    .banner-section {
      margin: 24px auto 0 auto;
      max-width: 1200px;
      border-radius: 18px;
      overflow: hidden;
      box-shadow: 0 4px 24px var(--shadow-light);
      background: var(--white);
    }
    .banner-slider { position: relative; width: 100%; height: 260px; }
    .banner-slide {
      width: 100%; height: 260px; object-fit: cover; display: none;
      transition: opacity 0.5s;
      border-radius: 18px;
      box-shadow: 0 2px 12px var(--shadow-light);
    }
    .banner-slide.active { display: block; }
    .banner-controls {
      position: absolute; bottom: 16px; left: 50%; transform: translateX(-50%);
      display: flex; gap: 8px;
    }
    .banner-dot {
      width: 12px; height: 12px; border-radius: 50%; background: #e0e7ef; border: 2px solid var(--gradient-mid); cursor: pointer;
      transition: background 0.2s;
    }
    .banner-dot.active { background: var(--gradient-mid); }
    /* Product grid */
    .products-section {
      width: 1200px;
      margin: 36px auto 0 auto;
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 4px 24px var(--shadow-light);
      padding: 32px 32px 40px 32px;
    }
    .products-title {
      font-size: 1.3rem;
      font-weight: 700;
      color: #088395;
      margin-bottom: 18px;
    }
    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
      gap: 22px;
    }
    .product-card {
      background: #f5fafd;
      border-radius: 0;
      box-shadow: 0 6px 32px #05bfdb55;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      transition: box-shadow 0.2s, transform 0.2s, border 0.2s;
      position: relative;
      border: 2px solid transparent;
    }
    .product-card:hover {
      box-shadow: 0 12px 48px #05bfdb77;
      transform: translateY(-3px) scale(1.03);
      border: 2px solid #05bfdb;
      background: #e0f7fa;
    }
    .product-img-wrap {
      width: 100%;
      height: 180px;
      background: #e0f7fa;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .product-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 12px 12px 0 0;
    }
    .product-info {
      padding: 10px 14px 16px 14px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .product-name {
      font-size: 1rem;
      font-weight: 600;
      min-height: 38px;
      max-height: 38px;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      color: #088395;
    }
    .product-price {
      color: #ee4d2d !important;
      font-size: 1.1rem;
      font-weight: 700;
      margin: 2px 0;
    }
    .product-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.95rem;
      color: #6b7280;
    }
    .product-rating {
      color: #ffc107 !important;
      font-weight: 700;
    }
    .product-address {
      font-size: 0.9rem;
      color: #aaa;
      margin-top: 2px;
    }
    /* Today Picks */
    .today-section { max-width: 1200px; margin: 36px auto 0 auto; background: var(--white); border-radius: 18px; box-shadow: 0 2px 12px var(--shadow-light); padding: 18px 0 10px 0; }
    .today-title { font-size: 1.2rem; font-weight: 700; color: var(--gradient-mid); margin-left: 32px; margin-bottom: 10px; }
    .today-slider { display: flex; gap: 18px; overflow-x: auto; padding: 0 32px; }
    .today-card {
      min-width: 180px; background: var(--white); border-radius: 12px; box-shadow: 0 2px 8px var(--shadow-light);
      display: flex; flex-direction: column; align-items: center; padding: 10px; position: relative;
      transition: box-shadow 0.2s, transform 0.2s, border 0.2s;
      border: 2px solid transparent;
    }
    .today-card:hover { box-shadow: 0 8px 24px var(--shadow-medium); transform: scale(1.04); border: 2px solid var(--gradient-end); }
    .today-img { width: 120px; height: 120px; object-fit: cover; border-radius: 10px; margin-bottom: 8px; background: var(--accent-gray); }
    .today-name { font-size: 1rem; font-weight: 600; min-height: 32px; max-height: 32px; overflow: hidden; text-align: center; color: var(--primary-black); }
    .today-price { color: var(--shopee-orange); font-size: 1.1rem; font-weight: 700; margin: 2px 0; }
    /* Footer */
    .main-footer {
      background: #e0f7fa;
      border-top: 1px solid #e5eaf2;
      padding: 18px 0;
      margin-top: 48px;
    }
    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      color: #088395;
      font-size: 14px;
    }
    @media (max-width: 900px) {
      .main-header { padding: 0 8px; }
      .banner-section, .category-section, .flashsale-section, .products-section, .today-section, .main-footer { max-width: 100vw; }
      .products-grid { grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); }
      .product-img-wrap { height: 110px; }
    }
    @media (max-width: 600px) {
      .main-header { flex-direction: column; height: auto; gap: 8px; }
      .search-bar { margin: 8px 0; }
      .products-grid { gap: 10px; }
      .footer-content { flex-direction: column; gap: 6px; align-items: center; }
    }
    .category-outer {
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 4px 24px var(--shadow-light);
      margin: 36px auto 0 auto;
      width: 1200px;
      min-width: 0;
      position: relative;
      padding: 24px 32px 32px 32px;
    }
    .category-header {
      font-size: 1.3rem;
      font-weight: 700;
      color: #088395;
      font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
      text-align: left;
      margin-bottom: 18px;
      margin-top: 0;
      margin-left: 0;
      margin-right: 0;
      padding: 0;
    }
    .category-grid-2x10 {
      display: grid;
      grid-template-columns: repeat(10, 1fr);
      grid-template-rows: repeat(2, 1fr);
      gap: 0;
      border-top: 1px solid #e0e7ef;
      border-left: 1px solid #e0e7ef;
      margin: 0;
      background: #f5fafd;
    }
    .category-cell {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border-right: 1px solid #e0e7ef;
      border-bottom: 1px solid #e0e7ef;
      background: #fff;
      aspect-ratio: 1/1;
      min-width: 0;
      min-height: 0;
      box-shadow: none;
      border-radius: 12px;
      padding: 0;
      transition: box-shadow 0.18s, border 0.18s;
    }
    .category-cell:hover {
      border: 2px solid #05bfdb;
      box-shadow: 0 0 0 2px #05bfdb, 0 4px 24px #05bfdb22;
      z-index: 2;
      background: #e0f7fa;
    }
    .category-cell.empty {
      background: #fff;
      border: none;
    }
    .category-imgwrap {
      width: 56px;
      height: 56px;
      background: #e0f7fa;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 10px;
      border: 1.5px solid #05bfdb44;
    }
    .category-imgwrap img {
      width: 40px;
      height: 40px;
      object-fit: contain;
      display: block;
    }
    .category-label {
      font-size: 1rem;
      font-weight: 500;
      color: #088395;
        text-align: center;
      margin: 0;
      line-height: 1.2;
      min-height: 32px;
      max-width: 90%;
      word-break: break-word;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      white-space: normal;
    }
    @media (max-width: 1600px) {
      .category-outer, .products-section { max-width: 100vw; }
    }
    @media (max-width: 1200px) {
      .category-header, .products-title { font-size: 1.1rem; }
      .category-grid-2x10 { grid-template-columns: repeat(5, 1fr); grid-template-rows: repeat(4, 1fr); }
    }
    .header-cart-link {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 48px;
      margin-left: 18px;
      cursor: pointer;
      text-decoration: none;
    }
    .header-cart-link img {
        height: 40px;
      width: 40px;
      filter: drop-shadow(0 2px 8px #05bfdb33);
    }
    .header-cart-link:hover img {
      transform: scale(1.08) rotate(-8deg);
      filter: drop-shadow(0 4px 16px #08839566);
    }
  </style>
</head>
<body>
<!-- Header Top Bar -->
<div class="header-top-bar" style="background: #fff; color: #111; font-size: 1rem; padding: 0 32px; height: 38px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid #e5eaf2;">
  <div class="header-top-left" style="display: flex; align-items: center; gap: 18px;">
    <a th:href="@{/sellerChannel}" style="color: #111; text-decoration: none; font-weight: 600;">Kênh Người Bán</a>
    <span style="color: #bbb;">|</span>
    <span style="font-weight: 600; color: #111;">Kết nối</span>
    <a th:href="@{/search}" style="margin-left: 6px; display: inline-flex; align-items: center;" title="Facebook">
      <svg width="28" height="28" viewBox="0 0 32 32" fill="none"><circle cx="16" cy="16" r="16" fill="#1877F3"/><path d="M21.333 16.001h-3.2v8h-3.2v-8h-2.133v-2.667h2.133v-1.6c0-2.133 1.067-3.2 3.2-3.2h2.133v2.667h-1.6c-.267 0-.533.267-.533.533v1.6h2.133l-.267 2.667z" fill="#fff"/></svg>
    </a>
    <a href="#" style="margin-left: 2px; display: inline-flex; align-items: center;" title="Instagram">
      <svg width="28" height="28" viewBox="0 0 32 32" fill="none"><radialGradient id="ig1" cx="16" cy="16" r="16" gradientUnits="userSpaceOnUse"><stop stop-color="#FFD600"/><stop offset="0.5" stop-color="#FF0069"/><stop offset="1" stop-color="#2827FF"/></radialGradient><circle cx="16" cy="16" r="16" fill="url(#ig1)"/><rect x="9" y="9" width="14" height="14" rx="4" fill="#fff"/><circle cx="16" cy="16" r="3.5" fill="#FF0069"/><circle cx="21.5" cy="10.5" r="1.5" fill="#FFD600"/></svg>
          </a>
        </div>
  <div class="header-top-right" style="display: flex; align-items: center; gap: 18px;">
    <a href="#" style="color: #1877F3; display: flex; align-items: center; gap: 4px; text-decoration: none; font-weight: 600;"><svg width="18" height="18" fill="none" viewBox="0 0 24 24"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6V11c0-3.07-1.63-5.64-5-6.32V4a1 1 0 1 0-2 0v.68C7.63 5.36 6 7.92 6 11v5l-1.29 1.29A.996.996 0 0 0 5 19h14a.996.996 0 0 0 .71-1.71L18 16z" fill="#1877F3"/><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6V11c0-3.07-1.63-5.64-5-6.32V4a1 1 0 1 0-2 0v.68C7.63 5.36 6 7.92 6 11v5l-1.29 1.29A.996.996 0 0 0 5 19h14a.996.996 0 0 0 .71-1.71L18 16z" fill="#1877F3"/></svg> Thông Báo</a>
    <th:block th:if="${customer}">
      <div class="user-info-box">
        <div class="user-avatar" th:if="${customer.image != null && !#strings.isEmpty(customer.image)}" style="background: none;">
          <img th:src="@{${customer.image}}" alt="avatar" style="width:32px;height:32px;border-radius:50%;object-fit:cover;" />
      </div>
        <span class="user-avatar" th:if="${customer.image == null || #strings.isEmpty(customer.image)}" th:text="${customer.firstname.substring(0,1)}"></span>
        <a class="account-link" th:text="${customer.firstname + ' ' + customer.lastname}" tabindex="0" style="color: #111 !important; font-weight: 700;"></a>
        <div class="account-menu-list">
          <a th:href="@{/customers/profile}">Tài khoản của tôi</a>
          <a th:href="@{/wallet}">Ví của tôi</a>
          <a th:href="@{/wishlist}">Danh sách yêu thích</a>
          <a th:href="@{/orders}">Đơn mua</a>
          <a th:href="@{/logout}">Đăng xuất</a>
    </div>
    </div>
    </th:block>
    <a th:unless="${customer}" href="/login" class="account-link" style="color:#fff;">Đăng nhập</a>
  </div>
      </div>
<!-- Main Header -->
<header class="main-header">
  <div class="header-left" style="display: flex; align-items: center; gap: 18px;">
    <a th:href="@{/home}" style="display: flex; align-items: center; gap: 8px; text-decoration: none;">
      <img src="/logo/logo.png" alt="Logo" class="logo-img" />
    </a>
        </div>
  <form class="search-bar" action="/search_name" method="GET" style="max-width: 900px; margin: 0 auto;">
    <input type="text" name="keyword" placeholder="Tìm kiếm sản phẩm, thương hiệu, danh mục..." />
    <button type="submit" aria-label="Tìm kiếm">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/><path d="m21 21-4.35-4.35" stroke="currentColor" stroke-width="2"/></svg>
          </button>
  </form>
  <a href="/cart" class="header-cart-link" title="Giỏ hàng">
    <img src="/logo/cart.png" alt="Giỏ hàng" />
  </a>
</header>
<!-- Danh mục giống hình, căn giữa với lưới sản phẩm -->
<div class="category-outer">
    <div class="category-header">Danh mục sản phẩm</div>
    <div class="category-grid-2x10">
        <th:block th:each="category,iter : ${categories}">
            <div class="category-cell" th:attr="data-category-id=${category.id}">
                <div class="category-imgwrap">
                    <img th:src="@{${category.image}}" alt="" />
        </div>
                <div class="category-label" th:text="${category.categoryname}"></div>
        </div>
        </th:block>
        <!-- Nếu ít hơn 20 category thì thêm ô trống để đủ 2x10 -->
        <th:block th:if="${#lists.size(categories) < 20}">
            <th:block th:each="i : ${#numbers.sequence(1, 20 - #lists.size(categories))}">
                <div class="category-cell empty"></div>
            </th:block>
        </th:block>
      </div>
      <!-- Category Pagination Controls -->
      <div class="pagination-container" style="display: flex; justify-content: center; align-items: center; gap: 0.5rem; margin-top: 1.5rem;">
        <form th:action="@{/home}" method="get" style="display: inline;">
          <input type="hidden" name="categoryPage" th:value="${categoryPage - 1}" />
          <button class="pagination-btn" type="submit" th:disabled="${categoryPage == 1}">&lt;</button>
        </form>
        <th:block th:each="pageNum : ${#numbers.sequence(1, totalCategoryPages > 10 ? 10 : totalCategoryPages)}">
          <form th:action="@{/home}" method="get" style="display: inline;">
            <input type="hidden" name="categoryPage" th:value="${pageNum}" />
            <button class="pagination-btn" type="submit" th:classappend="${categoryPage == pageNum} ? 'active'" th:text="${pageNum}"></button>
          </form>
        </th:block>
        <form th:action="@{/home}" method="get" style="display: inline;">
          <input type="hidden" name="categoryPage" th:value="${categoryPage + 1}" />
          <button class="pagination-btn" type="submit" th:disabled="${categoryPage == totalCategoryPages}">&gt;</button>
        </form>
      </div>
    </div>
<!-- Lưới sản phẩm -->
  <section class="products-section">
  <div class="products-title">Tất cả sản phẩm</div>
  <div class="products-grid">
    <div class="product-card" th:each="product : ${products}" th:onclick="|window.location.href='/detailproduct?id=${product.productId}'|">
      <div class="product-img-wrap">
        <img th:src="@{${product.imageUrl}}" alt="Ảnh sản phẩm" class="product-img" />
    </div>
        <div class="product-info">
        <div class="product-name" th:text="${product.name}"></div>
        <div class="product-price" th:text="'₫' + ${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT')}"></div>
          <div class="product-meta">
          <span th:text="'Đã bán ' + ${product.solditems}"></span>
          <span class="product-rating"><span th:text="${product.rate}"></span>★</span>
            </div>
        <div class="product-address" th:text="${product.shopaddress}"></div>
          </div>
          </div>
    </div>
  </section>
<!-- Footer -->
<footer class="main-footer">
  <div class="footer-content">
    <div>© 2024 E-Commerce Platform</div>
    <div>Liên hệ: support@example.com</div>
          </div>
</footer>
<form id="categoryForm" action="/search_category" method="get" style="display:none;">
  <input type="hidden" name="categoryId" id="categoryFormInput" />
</form>
<script>
  const userInfoBox = document.querySelector('.user-info-box');
  const menu = document.querySelector('.account-menu-list');
      let hideTimeout;
  if (userInfoBox && menu) {
    userInfoBox.addEventListener('mouseenter', () => {
        clearTimeout(hideTimeout);
      menu.style.display = 'block';
      menu.style.opacity = '1';
      menu.style.visibility = 'visible';
    });
    userInfoBox.addEventListener('mouseleave', () => {
      hideTimeout = setTimeout(() => {
        menu.style.display = '';
        menu.style.opacity = '';
        menu.style.visibility = '';
      }, 400);
    });
    menu.addEventListener('mouseenter', () => {
      clearTimeout(hideTimeout);
      menu.style.display = 'block';
      menu.style.opacity = '1';
      menu.style.visibility = 'visible';
    });
    menu.addEventListener('mouseleave', () => {
      hideTimeout = setTimeout(() => {
        menu.style.display = '';
        menu.style.opacity = '';
        menu.style.visibility = '';
      }, 400);
    });
  }
  // Category click handler
  document.querySelectorAll('.category-cell[data-category-id]').forEach(cell => {
    cell.style.cursor = 'pointer';
    cell.addEventListener('click', function() {
      const id = this.getAttribute('data-category-id');
      document.getElementById('categoryFormInput').value = id;
      document.getElementById('categoryForm').submit();
    });
  });
</script>
</body>
</html>