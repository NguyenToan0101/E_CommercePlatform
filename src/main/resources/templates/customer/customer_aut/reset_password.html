<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đặt lại mật khẩu</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #0a4d68;
            --secondary-blue: #088395;
            --accent-teal: #05bfdb;
            --light-green: #8de0a6;
            --light-gray: #f8f8f8;
            --border-gray: #e5e5e5;
            --text-gray: #666666;
            --white: #ffffff;
            --gold-accent: #d4af37;
            --error-red: #dc2626;
            --success-green: #10b981;
            --warning-orange: #f59e0b;
            --shadow-light: rgba(10, 77, 104, 0.05);
            --shadow-medium: rgba(10, 77, 104, 0.1);
            --shadow-heavy: rgba(10, 77, 104, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--light-green) 100%);
            min-height: 100vh;
            color: var(--primary-blue);
            line-height: 1.6;
            padding: 40px 20px;
            position: relative;
        }

        /* Animated background elements */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.5;
            animation: float 20s ease-in-out infinite;
            pointer-events: none;
            z-index: -1;
        }

        .container {
            max-width: 600px;
            width: 100%;
            position: relative;
            z-index: 1;
            margin: 0 auto;
        }

        /* Logo Section */
        .logo-section {
            text-align: center;
            margin-bottom: 40px;
            animation: fadeInDown 0.8s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .logo-container {
            display: inline-block;
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .logo-container:hover {
            transform: translateY(-2px);
        }

        .logo-placeholder {
            width: 140px;
            height: 60px;
            background: var(--white);
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-blue);
            font-size: 11px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px var(--shadow-light);
        }

        .logo-placeholder:hover {
            border-color: var(--accent-teal);
            background: var(--white);
            transform: scale(1.05);
        }

        /* Reset Container */
        .reset-container {
            background: var(--white);
            border-radius: 24px;
            box-shadow:
                    0 32px 64px var(--shadow-light),
                    0 16px 32px var(--shadow-medium),
                    0 0 0 1px rgba(255, 255, 255, 0.1);
            overflow: hidden;
            animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.2s both;
            position: relative;
            margin-bottom: 40px;
        }

        .reset-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-blue) 0%, var(--accent-teal) 50%, var(--primary-blue) 100%);
        }

        .reset-header {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
            color: var(--white);
            padding: 50px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .reset-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
        }

        .reset-icon {
            width: 100px;
            height: 100px;
            background: var(--white);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .reset-icon svg {
            width: 50px;
            height: 50px;
            color: var(--secondary-blue);
            animation: lockAnimation 2s ease-in-out infinite;
        }

        .reset-title {
            font-family: 'Playfair Display', serif;
            font-size: 36px;
            font-weight: 600;
            letter-spacing: -0.5px;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
            animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.3s both;
        }

        .reset-subtitle {
            font-size: 15px;
            opacity: 0.9;
            position: relative;
            z-index: 1;
            max-width: 400px;
            margin: 0 auto;
            animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.4s both;
        }

        .reset-body {
            padding: 50px 40px;
        }

        /* Instructions */
        .instructions {
            background: linear-gradient(135deg, rgba(8, 131, 149, 0.05) 0%, rgba(5, 191, 219, 0.05) 100%);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 30px;
            border-left: 4px solid var(--accent-teal);
            animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.5s both;
        }

        .instructions p {
            color: var(--text-gray);
            font-size: 14px;
            line-height: 1.7;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 30px;
            position: relative;
            animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.6s both;
        }

        .form-group:last-of-type {
            animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.7s both;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--primary-blue);
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .input-wrapper {
            position: relative;
        }

        .form-control {
            width: 100%;
            padding: 16px 20px;
            padding-right: 50px;
            border: 2px solid var(--border-gray);
            border-radius: 12px;
            font-size: 15px;
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            background: var(--light-gray);
            color: var(--primary-blue);
            font-family: inherit;
        }

        .form-control::placeholder {
            color: var(--text-gray);
            opacity: 0.7;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--secondary-blue);
            background: var(--white);
            box-shadow: 0 0 0 4px rgba(8, 131, 149, 0.1);
            transform: translateY(-2px);
        }

        .toggle-password {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-gray);
            padding: 8px;
            border-radius: 50%;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .toggle-password:hover {
            background: var(--light-gray);
            color: var(--secondary-blue);
        }

        .toggle-password svg {
            width: 20px;
            height: 20px;
        }

        /* Password Strength */
        .password-strength {
            height: 4px;
            background: var(--border-gray);
            border-radius: 2px;
            margin-top: 12px;
            overflow: hidden;
        }

        .strength-meter {
            height: 100%;
            width: 0;
            border-radius: 2px;
            transition: width 0.3s ease, background-color 0.3s ease;
        }

        .password-requirements {
            margin-top: 16px;
            padding: 16px;
            background: var(--light-gray);
            border-radius: 12px;
        }

        .requirements-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--primary-blue);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .requirement {
            display: block;
            font-size: 12px;
            color: var(--text-gray);
            margin-bottom: 6px;
            transition: color 0.3s ease;
            display: flex;
            align-items: center;
        }

        .requirement::before {
            content: '';
            display: inline-block;
            width: 14px;
            height: 14px;
            margin-right: 8px;
            border-radius: 50%;
            border: 2px solid var(--border-gray);
            flex-shrink: 0;
            transition: all 0.3s ease;
        }

        .requirement.met {
            color: var(--success-green);
            font-weight: 500;
        }

        .requirement.met::before {
            border-color: var(--success-green);
            background: var(--success-green);
            background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="white"/></svg>');
            background-position: center;
            background-repeat: no-repeat;
        }

        /* Submit Button */
        .submit-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--secondary-blue) 0%, var(--accent-teal) 100%);
            color: var(--white);
            padding: 18px 20px;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(8, 131, 149, 0.3);
            font-family: inherit;
            animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.8s both;
        }

        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.6s;
        }

        .submit-btn:hover::before {
            left: 100%;
        }

        .submit-btn:hover {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
            transform: translateY(-2px);
            box-shadow: 0 16px 32px rgba(8, 131, 149, 0.4);
        }

        .submit-btn:active {
            transform: translateY(-1px);
        }

        /* Loading state */
        .submit-btn.loading {
            color: transparent;
        }

        .submit-btn.loading::after {
            content: '';
            position: absolute;
            width: 24px;
            height: 24px;
            top: 50%;
            left: 50%;
            margin-left: -12px;
            margin-top: -12px;
            border: 2px solid var(--white);
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
        }

        /* Messages */
        .message {
            margin: 24px 0;
            padding: 16px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            text-align: center;
            animation: fadeIn 0.5s cubic-bezier(0.16, 1, 0.3, 1);
            border-left: 4px solid;
        }

        .success-message {
            background: rgba(8, 131, 149, 0.1);
            color: var(--secondary-blue);
            border-color: var(--secondary-blue);
        }

        .error-message {
            background: rgba(220, 38, 38, 0.1);
            color: var(--error-red);
            border-color: var(--error-red);
        }

        /* Back Link */
        .back-link {
            text-align: center;
            margin-top: 30px;
            animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.9s both;
        }

        .back-link a {
            color: var(--text-gray);
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .back-link a:hover {
            color: var(--secondary-blue);
        }

        .back-link a svg {
            width: 16px;
            height: 16px;
        }

        /* Animations */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        @keyframes lockAnimation {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-3px);
            }
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            body {
                padding: 20px 15px;
                min-height: auto;
            }

            .reset-header {
                padding: 40px 24px;
            }

            .reset-body {
                padding: 40px 24px;
            }

            .reset-title {
                font-size: 30px;
            }

            .reset-icon {
                width: 80px;
                height: 80px;
                margin-bottom: 20px;
            }

            .reset-icon svg {
                width: 40px;
                height: 40px;
            }

            .logo-placeholder {
                width: 120px;
                height: 50px;
                font-size: 10px;
            }
        }

        @media (max-width: 480px) {
            .reset-title {
                font-size: 26px;
            }

            .instructions {
                padding: 20px;
            }

            .form-group label {
                font-size: 12px;
            }

            .form-control {
                padding: 14px 16px;
                padding-right: 45px;
                font-size: 14px;
            }
        }

        /* Focus states for accessibility */
        .form-control:focus,
        .toggle-password:focus,
        .submit-btn:focus,
        .back-link a:focus {
            outline: 2px solid var(--accent-teal);
            outline-offset: 2px;
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            .form-control {
                border-width: 3px;
            }

            .submit-btn {
                border: 3px solid var(--secondary-blue);
            }
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <!-- Logo Section -->
    <div class="logo-section">
        <a href="/home" class="logo-container" aria-label="Về trang chủ">
            <div class="logo-placeholder">
                <!-- Replace this div with your logo image -->
                <span>Your Logo</span>
            </div>
        </a>
    </div>

    <div class="reset-container">
        <div class="reset-header">
            <div class="reset-icon">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="3" y="11" width="18" height="11" rx="2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M7 11V7C7 5.67392 7.52678 4.40215 8.46447 3.46447C9.40215 2.52678 10.6739 2 12 2C13.3261 2 14.5979 2.52678 15.5355 3.46447C16.4732 4.40215 17 5.67392 17 7V11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <circle cx="12" cy="16" r="1" fill="currentColor"/>
                </svg>
            </div>
            <h1 class="reset-title">Đặt lại mật khẩu</h1>
            <p class="reset-subtitle">Tạo mật khẩu mới an toàn cho tài khoản của bạn</p>
        </div>

        <div class="reset-body">
            <div class="instructions">
                <p>Vui lòng tạo một mật khẩu mới mạnh và an toàn. Mật khẩu tốt nên bao gồm chữ hoa, chữ thường, số và ký tự đặc biệt để bảo vệ tài khoản của bạn tốt nhất.</p>
            </div>

            <form th:action="@{/customers/reset_password}" method="post" id="resetPasswordForm">
                <input type="hidden" name="token" th:value="${token}" />

                <div class="form-group">
                    <label for="password">Mật khẩu mới</label>
                    <div class="input-wrapper">
                        <input type="password" name="password" id="password" class="form-control" required minlength="8" placeholder="Nhập mật khẩu mới">
                        <button type="button" class="toggle-password" aria-label="Hiện/ẩn mật khẩu" id="togglePassword">
                            <svg class="eye-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12C23 12 19 20 12 20C5 20 1 12 1 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                    <div class="password-strength">
                        <div class="strength-meter" id="strength-meter"></div>
                    </div>
                    <div class="password-requirements">
                        <div class="requirements-title">Yêu cầu mật khẩu:</div>
                        <span class="requirement" id="req-length">Ít nhất 8 ký tự</span>
                        <span class="requirement" id="req-upper">Có chữ hoa (A-Z)</span>
                        <span class="requirement" id="req-lower">Có chữ thường (a-z)</span>
                        <span class="requirement" id="req-number">Có số (0-9)</span>
                        <span class="requirement" id="req-special">Có ký tự đặc biệt (!@#$%^&*)</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="confirmPassword">Xác nhận mật khẩu</label>
                    <div class="input-wrapper">
                        <input type="password" name="confirmPassword" id="confirmPassword" class="form-control" required placeholder="Nhập lại mật khẩu mới">
                        <button type="button" class="toggle-password" aria-label="Hiện/ẩn mật khẩu xác nhận" id="toggleConfirmPassword">
                            <svg class="eye-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12C23 12 19 20 12 20C5 20 1 12 1 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <button type="submit" class="submit-btn" id="submitBtn">Đặt lại mật khẩu</button>
            </form>

            <div th:if="${message}" th:text="${message}" class="message success-message"></div>
            <div th:if="${errorMessage}" th:text="${errorMessage}" class="message error-message"></div>

            <div class="back-link">
                <a th:href="@{/login}">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 12H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Quay lại trang đăng nhập
                </a>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Password toggle functionality
        const togglePassword = document.getElementById('togglePassword');
        const toggleConfirmPassword = document.getElementById('toggleConfirmPassword');
        const passwordInput = document.getElementById('password');
        const confirmPasswordInput = document.getElementById('confirmPassword');

        function setupPasswordToggle(toggleBtn, inputField) {
            toggleBtn.addEventListener('click', function() {
                // Toggle type between password and text
                const type = inputField.getAttribute('type') === 'password' ? 'text' : 'password';
                inputField.setAttribute('type', type);

                // Toggle icon
                if (type === 'text') {
                    this.innerHTML = `
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M2 12C2 12 5.5 5 12 5C18.5 5 22 12 22 12C22 12 18.5 19 12 19C5.5 19 2 12 2 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M3 3L21 21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        `;
                } else {
                    this.innerHTML = `
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12C23 12 19 20 12 20C5 20 1 12 1 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        `;
                }
            });
        }

        setupPasswordToggle(togglePassword, passwordInput);
        setupPasswordToggle(toggleConfirmPassword, confirmPasswordInput);

        // Password strength checker
        const strengthMeter = document.getElementById('strength-meter');
        const requirements = {
            length: document.getElementById('req-length'),
            upper: document.getElementById('req-upper'),
            lower: document.getElementById('req-lower'),
            number: document.getElementById('req-number'),
            special: document.getElementById('req-special')
        };

        passwordInput.addEventListener('input', checkPasswordStrength);

        function checkPasswordStrength() {
            const value = passwordInput.value;

            // Check requirements
            const checks = {
                length: value.length >= 8,
                upper: /[A-Z]/.test(value),
                lower: /[a-z]/.test(value),
                number: /[0-9]/.test(value),
                special: /[!@#$%^&*(),.?":{}|<>]/.test(value)
            };

            // Update requirement classes
            for (const [key, element] of Object.entries(requirements)) {
                element.classList.toggle('met', checks[key]);
            }

            // Calculate strength percentage
            const metCount = Object.values(checks).filter(Boolean).length;
            const strengthPercentage = (metCount / 5) * 100;

            // Update strength meter with animation
            strengthMeter.style.width = `${strengthPercentage}%`;

            // Set color based on strength
            if (strengthPercentage <= 20) {
                strengthMeter.style.backgroundColor = '#dc2626'; // Red
            } else if (strengthPercentage <= 40) {
                strengthMeter.style.backgroundColor = '#f59e0b'; // Orange
            } else if (strengthPercentage <= 60) {
                strengthMeter.style.backgroundColor = '#d4af37'; // Gold
            } else if (strengthPercentage <= 80) {
                strengthMeter.style.backgroundColor = '#8bc34a'; // Light green
            } else {
                strengthMeter.style.backgroundColor = '#10b981'; // Green
            }

            return metCount;
        }

        // Check password match
        confirmPasswordInput.addEventListener('input', function() {
            validatePasswordMatch();
        });

        function validatePasswordMatch() {
            const password = passwordInput.value;
            const confirmPassword = confirmPasswordInput.value;

            if (confirmPassword) {
                if (password !== confirmPassword) {
                    confirmPasswordInput.style.borderColor = '#dc2626';
                    return false;
                } else {
                    confirmPasswordInput.style.borderColor = '#10b981';
                    return true;
                }
            }
            return false;
        }

        // Form validation
        document.getElementById('resetPasswordForm').addEventListener('submit', function(e) {
            // Check password strength
            const metRequirements = checkPasswordStrength();

            if (metRequirements < 3) {
                e.preventDefault();

                // Create error message
                showMessage('Mật khẩu không đủ mạnh. Vui lòng đáp ứng ít nhất 3 yêu cầu.', 'error');

                // Focus on password field
                passwordInput.focus();
                return;
            }

            // Check if passwords match
            if (!validatePasswordMatch()) {
                e.preventDefault();

                // Create error message
                showMessage('Mật khẩu xác nhận không khớp với mật khẩu mới.', 'error');

                // Focus on confirm password field
                confirmPasswordInput.focus();
                return;
            }

            // Add loading state
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.classList.add('loading');
            submitBtn.disabled = true;
        });

        // Show message function
        function showMessage(text, type) {
            // Remove any existing messages
            const existingMessages = document.querySelectorAll('.message');
            existingMessages.forEach(msg => msg.remove());

            // Create new message
            const message = document.createElement('div');
            message.className = `message ${type === 'error' ? 'error-message' : 'success-message'}`;
            message.textContent = text;

            // Insert after form
            const form = document.getElementById('resetPasswordForm');
            form.after(message);

            // Auto-hide after 5 seconds
            setTimeout(() => {
                message.style.opacity = '0';
                setTimeout(() => {
                    message.remove();
                }, 500);
            }, 5000);
        }

        // Auto-hide existing messages after 5 seconds
        setTimeout(() => {
            const messages = document.querySelectorAll('.message');
            messages.forEach(message => {
                if (message.textContent.trim() !== '') {
                    message.style.transition = 'opacity 0.5s ease';
                    message.style.opacity = '0';
                    setTimeout(() => {
                        message.style.display = 'none';
                    }, 500);
                }
            });
        }, 5000);

        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Submit form on Enter when focused on confirm password
            if (e.key === 'Enter' && document.activeElement === confirmPasswordInput) {
                e.preventDefault();
                document.getElementById('submitBtn').click();
            }

            // Toggle password visibility on Alt+V
            if (e.key === 'v' && e.altKey) {
                e.preventDefault();
                if (document.activeElement === passwordInput || document.activeElement === confirmPasswordInput) {
                    const toggleBtn = document.activeElement === passwordInput ? togglePassword : toggleConfirmPassword;
                    toggleBtn.click();
                }
            }
        });
    });
</script>
</body>
</html>